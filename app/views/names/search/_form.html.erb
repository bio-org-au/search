<%= form_tag(names_search_path, method: "get", id: "search-form") do %>
  <div class="form-group row">
    <%= label_tag(:q,
                  "Search for:",
                  class:"sr-only col-sm-2 form-control-label") %>
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-7">
    <%= search_field_tag(:q,
                       '',
                       class: "form-control",
                       name: "q",
                       value: "#{params[:q]}",
                       autofocus: true,
                       required: true,
                       title: "Enter a name with or without wildcards.",
                       placeholder: "Search Names") %>
    </div>
    <span class="hidden-md-up">&nbsp;&nbsp;&nbsp;</span>
    <%= button_tag(id: "search-button", type: "submit", class: "btn white nsl-blue-bg hidden-print", title: "Search names")  do %>
      <%= fa_icon('search') %>&nbsp;Names
    <% end %>
    <%= link_to("#{fa_icon('search')} Taxonomy".html_safe,
              taxonomy_accepted_search_path(q:''),
              id: "search-taxonomy-link",
              class: "alt-search-link btn btn-secondary hidden-print",
              title: "Switch to taxonomy search") %>
    <input type="hidden" 
           value="<%= session[:always_details].blank? ? false : session[:always_details] %>"
           name="retrieve_details_on_load"
           id="retrieve_details_on_load">
    <input type="hidden" 
           value="<%= params[:search_type].blank? ? 'scientific' : params[:search_type] %>"
           name="search_type"
           id="name_type">
    <input type="hidden" 
           value="html"
           name="format"
           id="search-output-format">
  </div>
<% end %>
<span class="debug red hidden-print">[names/search/_form]</span>

<%= render "names/search/help_text" %>

<% if @search.present? %>
  <span class='search-result-summary'>
    <%= pluralize(@search.results.pluck("id").uniq.size,
                  "#{(params[:search_type] || 'scientific').sub(/-and-/,' or ')} name") %>
    <%= no_results_help(@search.results.size).html_safe %>
  </span>
<% end %>

<% if @search.present? %>
  <%= render partial: '/names/search/results', locals: {search: @search, name: @search.results.first} %>
<% end %>

<script>
  window.addClearButton();
</script>
